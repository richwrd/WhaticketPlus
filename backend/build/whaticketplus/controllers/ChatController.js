const a15_0x512c1c=a15_0x2705;(function(_0x307e14,_0x5856cb){const _0x3c5cb3=a15_0x2705,_0x180df9=_0x307e14();while(!![]){try{const _0x4d0f4d=parseInt(_0x3c5cb3(0x15b))/0x1+parseInt(_0x3c5cb3(0xf5))/0x2*(-parseInt(_0x3c5cb3(0x17c))/0x3)+-parseInt(_0x3c5cb3(0x1ae))/0x4+-parseInt(_0x3c5cb3(0x160))/0x5*(-parseInt(_0x3c5cb3(0x135))/0x6)+parseInt(_0x3c5cb3(0x168))/0x7+-parseInt(_0x3c5cb3(0x166))/0x8*(parseInt(_0x3c5cb3(0x169))/0x9)+parseInt(_0x3c5cb3(0xf2))/0xa;if(_0x4d0f4d===_0x5856cb)break;else _0x180df9['push'](_0x180df9['shift']());}catch(_0x24f4e1){_0x180df9['push'](_0x180df9['shift']());}}}(a15_0x1b1c,0x58c27));const a15_0xe45c6c=(function(){const _0x5d43c2=a15_0x2705,_0x37002a={};_0x37002a[_0x5d43c2(0x121)]=function(_0x38fcbd,_0x3885c1){return _0x38fcbd===_0x3885c1;},_0x37002a['BfuVG']=_0x5d43c2(0x177),_0x37002a[_0x5d43c2(0x13a)]=function(_0x1d2f17,_0x3b88c4){return _0x1d2f17+_0x3b88c4;};const _0x488350=_0x37002a;let _0x98bf02=!![];return function(_0x42e10c,_0x36828c){const _0x49218b={'mCqMP':function(_0x3f486b,_0x3857db){return _0x488350['lBwKZ'](_0x3f486b,_0x3857db);}},_0x27e01d=_0x98bf02?function(){const _0x4c16e7=a15_0x2705;if(_0x488350[_0x4c16e7(0x121)]('fGMbE',_0x488350['BfuVG']))(function(){return![];}[_0x4c16e7(0x17f)](_0x49218b[_0x4c16e7(0x12a)]('debu',_0x4c16e7(0x152)))['apply'](_0x4c16e7(0x132)));else{if(_0x36828c){const _0x37a61c=_0x36828c[_0x4c16e7(0xfe)](_0x42e10c,arguments);return _0x36828c=null,_0x37a61c;}}}:function(){};return _0x98bf02=![],_0x27e01d;};}()),a15_0x308c06=a15_0xe45c6c(this,function(){const _0x52dd07=a15_0x2705,_0x2f4ccc={};_0x2f4ccc[_0x52dd07(0x115)]='(((.+)+)+)+$';const _0x5d7e88=_0x2f4ccc;return a15_0x308c06[_0x52dd07(0x102)]()[_0x52dd07(0x198)](_0x5d7e88['AQDUN'])[_0x52dd07(0x102)]()['constructor'](a15_0x308c06)[_0x52dd07(0x198)](_0x5d7e88[_0x52dd07(0x115)]);});a15_0x308c06();const a15_0xa7a235=(function(){const _0x165d82=a15_0x2705,_0x7626b6={};_0x7626b6[_0x165d82(0x1b2)]=function(_0x461527,_0x5cbb52){return _0x461527===_0x5cbb52;},_0x7626b6[_0x165d82(0xfb)]='vDcXz',_0x7626b6[_0x165d82(0xf6)]=function(_0x26b7aa,_0x54bc7b){return _0x26b7aa===_0x54bc7b;},_0x7626b6[_0x165d82(0x137)]=_0x165d82(0x139);const _0xe3fef3=_0x7626b6;let _0x1324e8=!![];return function(_0xa640ce,_0x5556b0){const _0x4d5a41=_0x165d82;if(_0xe3fef3[_0x4d5a41(0xf6)](_0xe3fef3[_0x4d5a41(0x137)],_0xe3fef3[_0x4d5a41(0x137)])){const _0x2d64b1=_0x1324e8?function(){const _0x4481ad=_0x4d5a41;if(_0x5556b0){if(_0xe3fef3['AVlxP']('vDcXz',_0xe3fef3[_0x4481ad(0xfb)])){const _0x12e406=_0x5556b0[_0x4481ad(0xfe)](_0xa640ce,arguments);return _0x5556b0=null,_0x12e406;}else{const _0x4fe1b4=_0x5c68b4[_0x4481ad(0x17f)]['prototype'][_0x4481ad(0x146)](_0x4bfe82),_0x3eff37=_0xccd89e[_0x2e1612],_0x370291=_0x1885d1[_0x3eff37]||_0x4fe1b4;_0x4fe1b4[_0x4481ad(0x148)]=_0x213beb[_0x4481ad(0x146)](_0x2264e6),_0x4fe1b4['toString']=_0x370291[_0x4481ad(0x102)][_0x4481ad(0x146)](_0x370291),_0x1a38db[_0x3eff37]=_0x4fe1b4;}}}:function(){};return _0x1324e8=![],_0x2d64b1;}else _0x1befd7=_0x4ce2f3;};}());(function(){const _0x2e1558=a15_0x2705,_0x4c5ad5={'doByh':function(_0x509555,_0x13be21){return _0x509555(_0x13be21);},'sgPuL':_0x2e1558(0x159),'DSYpo':_0x2e1558(0x185),'KIlfl':function(_0x50864f,_0x467baa){return _0x50864f+_0x467baa;},'DtANX':_0x2e1558(0x18e),'RVXRd':_0x2e1558(0x154),'UQkJm':function(_0x57a002){return _0x57a002();},'Uovek':function(_0x48e3be,_0x148ed7){return _0x48e3be===_0x148ed7;},'NqYuW':_0x2e1558(0x187),'yliNp':_0x2e1558(0x150),'CJgYb':function(_0x5cde8b,_0x2d2247){return _0x5cde8b+_0x2d2247;},'ZyIFQ':_0x2e1558(0x19f),'XHmNK':_0x2e1558(0x151),'rJYvE':function(_0x3972d5,_0x472dab,_0x53d988){return _0x3972d5(_0x472dab,_0x53d988);}};_0x4c5ad5[_0x2e1558(0x161)](a15_0xa7a235,this,function(){const _0x170a42=_0x2e1558,_0x149f0f={'fczLH':function(_0x16007d,_0x108b4e){const _0x4ec659=a15_0x2705;return _0x4c5ad5[_0x4ec659(0x171)](_0x16007d,_0x108b4e);},'IbqXV':_0x4c5ad5['sgPuL'],'ZrvpH':_0x4c5ad5[_0x170a42(0x11a)],'kvcyO':function(_0x35bee7,_0x178e71){const _0x538685=_0x170a42;return _0x4c5ad5[_0x538685(0x16c)](_0x35bee7,_0x178e71);},'sxkVa':_0x4c5ad5['DtANX'],'XROir':_0x4c5ad5[_0x170a42(0x105)],'aQCgR':function(_0x3f715c){const _0x28619d=_0x170a42;return _0x4c5ad5[_0x28619d(0x107)](_0x3f715c);}};if(_0x4c5ad5['Uovek'](_0x4c5ad5['NqYuW'],_0x4c5ad5['yliNp']))return!![];else{const _0x3c8de5=new RegExp(_0x4c5ad5['sgPuL']),_0x86dee=new RegExp(_0x170a42(0x185),'i'),_0xf46b19=a15_0x25159c(_0x170a42(0x120));!_0x3c8de5[_0x170a42(0xfd)](_0x4c5ad5[_0x170a42(0x140)](_0xf46b19,_0x4c5ad5[_0x170a42(0x103)]))||!_0x86dee[_0x170a42(0xfd)](_0x4c5ad5[_0x170a42(0x16c)](_0xf46b19,_0x4c5ad5[_0x170a42(0x105)]))?_0x4c5ad5['ZyIFQ']===_0x4c5ad5['XHmNK']?_0x149f0f[_0x170a42(0x108)](_0x3c276e,'0'):_0x4c5ad5[_0x170a42(0x171)](_0xf46b19,'0'):_0x4c5ad5[_0x170a42(0x13c)](_0x170a42(0x111),_0x170a42(0x129))?_0x5dd064(this,function(){const _0x2b5bcc=_0x170a42,_0x4df47b=new _0x3c9d9a(_0x149f0f['IbqXV']),_0x5f2e28=new _0x3be1db(_0x149f0f[_0x2b5bcc(0x119)],'i'),_0x1a0c97=_0x162830(_0x2b5bcc(0x120));!_0x4df47b[_0x2b5bcc(0xfd)](_0x149f0f['kvcyO'](_0x1a0c97,_0x149f0f[_0x2b5bcc(0x16a)]))||!_0x5f2e28[_0x2b5bcc(0xfd)](_0x1a0c97+_0x149f0f['XROir'])?_0x1a0c97('0'):_0x149f0f[_0x2b5bcc(0xf1)](_0x248b87);})():_0x4c5ad5[_0x170a42(0x107)](a15_0x25159c);}})();}());const a15_0x44c38d=(function(){const _0x249ad9=a15_0x2705,_0x662663={};_0x662663[_0x249ad9(0x14c)]=function(_0x2ceb2a,_0x13dd69){return _0x2ceb2a===_0x13dd69;},_0x662663[_0x249ad9(0xf3)]=_0x249ad9(0x18f),_0x662663[_0x249ad9(0x149)]=function(_0x5f4e88,_0x42baa3){return _0x5f4e88!==_0x42baa3;},_0x662663[_0x249ad9(0x147)]=_0x249ad9(0x1aa),_0x662663[_0x249ad9(0x136)]=function(_0x23ecb1,_0x14bfc0){return _0x23ecb1+_0x14bfc0;},_0x662663[_0x249ad9(0x125)]=_0x249ad9(0x1b1),_0x662663[_0x249ad9(0x1a9)]=_0x249ad9(0x1a4),_0x662663[_0x249ad9(0x165)]=function(_0x4705ea,_0x31748c){return _0x4705ea!==_0x31748c;},_0x662663['BLrkl']=_0x249ad9(0x19e),_0x662663[_0x249ad9(0x123)]=_0x249ad9(0x124);const _0x430488=_0x662663;let _0x1e3d5a=!![];return function(_0x47f9eb,_0x434871){const _0xa8fe0=_0x249ad9,_0x345bfa={'LiHdv':function(_0x483a79,_0x467e22){const _0x45e69c=a15_0x2705;return _0x430488[_0x45e69c(0x136)](_0x483a79,_0x467e22);},'KSZDC':_0x430488['gjnkK'],'rnpcr':_0x430488[_0xa8fe0(0x1a9)]};if(_0x430488['KJSRl'](_0x430488[_0xa8fe0(0x175)],_0x430488[_0xa8fe0(0x123)])){const _0x26b67c=_0x1e3d5a?function(){const _0x5742ed=_0xa8fe0;if(_0x430488[_0x5742ed(0x14c)]('OIhrh',_0x430488[_0x5742ed(0xf3)])){const _0x598074=_0x2c4a20['apply'](_0xe7dd4c,arguments);return _0x5e38ee=null,_0x598074;}else{if(_0x434871){if(_0x430488['ubEys']('yVhsa',_0x430488['KRpum'])){const _0x4d23dd=_0x5e820a?function(){const _0x1cd8a8=_0x5742ed;if(_0x3d3d1a){const _0x4f66b0=_0x283bf1[_0x1cd8a8(0xfe)](_0x5126d5,arguments);return _0x45ade7=null,_0x4f66b0;}}:function(){};return _0x13e04b=![],_0x4d23dd;}else{const _0x30d833=_0x434871['apply'](_0x47f9eb,arguments);return _0x434871=null,_0x30d833;}}}}:function(){};return _0x1e3d5a=![],_0x26b67c;}else(function(){return!![];}[_0xa8fe0(0x17f)](_0x345bfa[_0xa8fe0(0x14e)](_0x345bfa['KSZDC'],_0xa8fe0(0x152)))[_0xa8fe0(0x144)](_0x345bfa['rnpcr']));};}()),a15_0x236bd0=a15_0x44c38d(this,function(){const _0x29f641=a15_0x2705,_0x5cac88={'SQQUv':function(_0x22d572,_0x1565de){return _0x22d572===_0x1565de;},'TjLoC':_0x29f641(0x19b),'TKpXQ':'cSYMo','hRqOI':function(_0x556b94,_0xedeaa8){return _0x556b94(_0xedeaa8);},'pYahd':function(_0xd5d4f0,_0x5632f8){return _0xd5d4f0+_0x5632f8;},'qunlv':_0x29f641(0x1a5),'kXJPo':_0x29f641(0x17d),'pWXDj':function(_0x15e57a){return _0x15e57a();},'Shysn':_0x29f641(0x173),'QxAwS':'info','GdZiG':_0x29f641(0x19a),'szcPD':_0x29f641(0x126),'xWmjD':'trace','aZWAw':function(_0x491d5a,_0x59d0ba){return _0x491d5a<_0x59d0ba;}},_0x2d63ff=function(){const _0x3450f6=_0x29f641;if(_0x5cac88[_0x3450f6(0x15d)](_0x5cac88[_0x3450f6(0x127)],_0x5cac88[_0x3450f6(0x13f)]))return _0x43d384;else{let _0x1c9471;try{_0x1c9471=_0x5cac88[_0x3450f6(0x17a)](Function,_0x5cac88[_0x3450f6(0x199)](_0x5cac88[_0x3450f6(0x199)](_0x5cac88[_0x3450f6(0xf0)],_0x5cac88[_0x3450f6(0x109)]),');'))();}catch(_0x241463){_0x1c9471=window;}return _0x1c9471;}},_0x293228=_0x5cac88[_0x29f641(0x180)](_0x2d63ff),_0x2090de=_0x293228[_0x29f641(0x145)]=_0x293228[_0x29f641(0x145)]||{},_0x568f3f=[_0x5cac88[_0x29f641(0x1a1)],_0x29f641(0x194),_0x5cac88[_0x29f641(0x17e)],_0x5cac88['GdZiG'],_0x29f641(0x10c),_0x5cac88[_0x29f641(0x11e)],_0x5cac88['xWmjD']];for(let _0x302752=0x0;_0x5cac88[_0x29f641(0x167)](_0x302752,_0x568f3f[_0x29f641(0x179)]);_0x302752++){const _0xe6c015=a15_0x44c38d[_0x29f641(0x17f)][_0x29f641(0x14b)]['bind'](a15_0x44c38d),_0x162c7=_0x568f3f[_0x302752],_0x51083a=_0x2090de[_0x162c7]||_0xe6c015;_0xe6c015['__proto__']=a15_0x44c38d[_0x29f641(0x146)](a15_0x44c38d),_0xe6c015[_0x29f641(0x102)]=_0x51083a['toString'][_0x29f641(0x146)](_0x51083a),_0x2090de[_0x162c7]=_0xe6c015;}});a15_0x236bd0();'use strict';var __importDefault=this&&this[a15_0x512c1c(0x100)]||function(_0x26b647){const _0x1c8ed5=a15_0x512c1c;return _0x26b647&&_0x26b647[_0x1c8ed5(0xfa)]?_0x26b647:{'default':_0x26b647};};const a15_0xea3b77={};a15_0xea3b77[a15_0x512c1c(0x10b)]=!![],Object['defineProperty'](exports,a15_0x512c1c(0xfa),a15_0xea3b77),exports[a15_0x512c1c(0x163)]=exports[a15_0x512c1c(0x188)]=exports[a15_0x512c1c(0x13e)]=exports[a15_0x512c1c(0x16f)]=exports[a15_0x512c1c(0x11f)]=exports[a15_0x512c1c(0x174)]=exports[a15_0x512c1c(0x10d)]=exports[a15_0x512c1c(0x104)]=void 0x0;const socket_1=require('../libs/socket'),CreateService_1=__importDefault(require('../services/ChatService/CreateService')),ListService_1=__importDefault(require(a15_0x512c1c(0xf8))),ShowFromUuidService_1=__importDefault(require(a15_0x512c1c(0xf9))),DeleteService_1=__importDefault(require('../services/ChatService/DeleteService')),FindMessages_1=__importDefault(require(a15_0x512c1c(0x10a))),UpdateService_1=__importDefault(require(a15_0x512c1c(0x178))),lodash_1=require('lodash'),Chat_1=__importDefault(require(a15_0x512c1c(0x1ab))),User_1=__importDefault(require(a15_0x512c1c(0x18a))),ChatUser_1=__importDefault(require(a15_0x512c1c(0x122))),CreateMessageService_1=__importDefault(require(a15_0x512c1c(0x197))),index=async(_0x458458,_0x414037)=>{const _0x1cc3e0=a15_0x512c1c,{pageNumber:_0x4ea08d}=_0x458458[_0x1cc3e0(0x156)],_0x58567c=+_0x458458[_0x1cc3e0(0x142)]['id'],_0x20f004={};_0x20f004['ownerId']=_0x58567c,_0x20f004[_0x1cc3e0(0x176)]=_0x4ea08d;const {records:_0x9f5dd2,count:_0x5ab55a,hasMore:_0x46bf08}=await(0x0,ListService_1[_0x1cc3e0(0x15f)])(_0x20f004),_0x2364d7={};return _0x2364d7[_0x1cc3e0(0x182)]=_0x9f5dd2,_0x2364d7[_0x1cc3e0(0x113)]=_0x5ab55a,_0x2364d7['hasMore']=_0x46bf08,_0x414037['json'](_0x2364d7);};exports['index']=index;const store=async(_0x4508c6,_0x58c68c)=>{const _0xacc926=a15_0x512c1c,{companyId:_0x39c32d}=_0x4508c6[_0xacc926(0x142)],_0x2bde54=+_0x4508c6[_0xacc926(0x142)]['id'],_0x285da9=_0x4508c6[_0xacc926(0x10f)],_0xff016c={..._0x285da9};_0xff016c[_0xacc926(0x12c)]=_0x2bde54,_0xff016c[_0xacc926(0x112)]=_0x39c32d;const _0x5bdd88=await(0x0,CreateService_1[_0xacc926(0x15f)])(_0xff016c),_0x5a179b=(0x0,socket_1[_0xacc926(0x117)])();return _0x5bdd88[_0xacc926(0x1a6)][_0xacc926(0x16d)](_0x5e7de7=>{const _0x342b70=_0xacc926,_0x328ccd={};_0x328ccd['action']=_0x342b70(0x196),_0x328ccd['record']=_0x5bdd88,_0x5a179b[_0x342b70(0x1a7)](_0x342b70(0x16b)+_0x39c32d+'-chat-user-'+_0x5e7de7[_0x342b70(0x172)],_0x328ccd);}),_0x58c68c[_0xacc926(0x11d)](0xc8)[_0xacc926(0x162)](_0x5bdd88);};exports[a15_0x512c1c(0x10d)]=store;const update=async(_0x134e17,_0x3ac044)=>{const _0xcc7b9d=a15_0x512c1c,_0x51272b={};_0x51272b[_0xcc7b9d(0x186)]=_0xcc7b9d(0x174);const _0x3eb50e=_0x51272b,{companyId:_0x34142}=_0x134e17[_0xcc7b9d(0x142)],_0xbf73de=_0x134e17[_0xcc7b9d(0x10f)],{id:_0x2ce35b}=_0x134e17[_0xcc7b9d(0x1a8)],_0x22889a={..._0xbf73de};_0x22889a['id']=+_0x2ce35b;const _0x326350=await(0x0,UpdateService_1[_0xcc7b9d(0x15f)])(_0x22889a),_0x5cd5a6=(0x0,socket_1[_0xcc7b9d(0x117)])();return _0x326350['users'][_0xcc7b9d(0x16d)](_0x4b3056=>{const _0x78b0bd=_0xcc7b9d,_0x5dc3a4={};_0x5dc3a4['action']=_0x3eb50e[_0x78b0bd(0x186)],_0x5dc3a4[_0x78b0bd(0x141)]=_0x326350,_0x5cd5a6[_0x78b0bd(0x1a7)](_0x78b0bd(0x16b)+_0x34142+_0x78b0bd(0x12b)+_0x4b3056[_0x78b0bd(0x172)],_0x5dc3a4);}),_0x3ac044['status'](0xc8)[_0xcc7b9d(0x162)](_0x326350);};function a15_0x1b1c(){const _0x11e23a=['lFgUG','ZEuon','../services/ChatService/ListService','../services/ChatService/ShowFromUuidService','__esModule','SBRwx','typeFile','test','apply','ESInn','__importDefault','OkFbL','toString','DtANX','index','RVXRd','chatId','UQkJm','fczLH','kXJPo','../services/ChatService/FindMessages','value','exception','store','HbGlu','body','mimetype','limVR','companyId','count','cIdRi','AQDUN','okvfu','getIO','VhDXE','ZrvpH','DSYpo','filename','SdrVW','status','szcPD','show','init','JRIvi','../models/ChatUser','MeORY','sBfHh','gjnkK','table','TjLoC','hasMore','sJqUI','mCqMP','-chat-user-','ownerId','senderId','DsIKB','sfWRI','chat','owner','stateObject','findByPk','ZJBGc','2394fcXBjG','dCWif','iezHG','veaVx','mWxUY','lBwKZ','counter','Uovek','delete','saveMessage','TKpXQ','CJgYb','record','user','yVeJP','call','console','bind','KRpum','__proto__','ubEys','upFod','prototype','hzUDT','newMessage','LiHdv','ppVVK','HSgyZ','fEOgV','gger','LGUaA','input','model','query','Chat\x20deleted','UxaVF','function\x20*\x5c(\x20*\x5c)','NkRaa','589700OjIqus','EkbpY','SQQUv','PIHGc','default','7325TOVmaN','rJYvE','json','messages','head','KJSRl','3115832tfdobT','aZWAw','493073JpWjMY','9fAauew','sxkVa','company-','KIlfl','forEach','message','remove','LnSdZ','doByh','userId','log','update','BLrkl','pageNumber','IagGh','../services/ChatService/UpdateService','length','hRqOI','ESSMW','503127BRXkZJ','{}.constructor(\x22return\x20this\x22)(\x20)','QxAwS','constructor','pWXDj','lTgXF','records','-chat','ZBcvu','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','BRHEU','lYPLe','checkAsRead','include','../models/User','while\x20(true)\x20{}','where','YDmlC','chain','NDcNl','mediaName','GaUle','hmqGs','new-message','warn','blSMG','create','../services/ChatService/CreateMessageService','search','pYahd','error','GSTas','IFhMD','ekiZl','SgFxb','sZeNI','aCRxT','Shysn','BvjaC','DWJFa','action','return\x20(function()\x20','users','emit','params','CNBAQ','yVhsa','../models/Chat','jCDfR','ezKSh','1114112alwVUF','nmlUo','hfTYT','debu','AVlxP','mediaPath','qunlv','aQCgR','2900190OVzYrz','QezfM','GlorX','6wxrsSb'];a15_0x1b1c=function(){return _0x11e23a;};return a15_0x1b1c();}exports[a15_0x512c1c(0x174)]=update;const show=async(_0x12bbcc,_0x5a1ff2)=>{const _0x4ae58f=a15_0x512c1c,{id:_0x3b4c15}=_0x12bbcc[_0x4ae58f(0x1a8)],_0x4cf11d=await(0x0,ShowFromUuidService_1[_0x4ae58f(0x15f)])(_0x3b4c15);return _0x5a1ff2[_0x4ae58f(0x11d)](0xc8)[_0x4ae58f(0x162)](_0x4cf11d);};exports[a15_0x512c1c(0x11f)]=show;const remove=async(_0x2dcd8b,_0x4932b9)=>{const _0x503876=a15_0x512c1c,_0xca02b2={};_0xca02b2[_0x503876(0x1af)]=_0x503876(0x13d),_0xca02b2[_0x503876(0x118)]=_0x503876(0x157);const _0x3e4018=_0xca02b2,{id:_0x4863cc}=_0x2dcd8b['params'],{companyId:_0x4e5498}=_0x2dcd8b[_0x503876(0x142)];await(0x0,DeleteService_1[_0x503876(0x15f)])(_0x4863cc);const _0x277608=(0x0,socket_1[_0x503876(0x117)])(),_0x38c8f7={};_0x38c8f7[_0x503876(0x1a4)]=_0x3e4018[_0x503876(0x1af)],_0x38c8f7['id']=_0x4863cc,_0x277608[_0x503876(0x1a7)](_0x503876(0x16b)+_0x4e5498+_0x503876(0x183),_0x38c8f7);const _0x5a3d6f={};return _0x5a3d6f[_0x503876(0x16e)]=_0x3e4018['VhDXE'],_0x4932b9[_0x503876(0x11d)](0xc8)['json'](_0x5a3d6f);};exports[a15_0x512c1c(0x16f)]=remove;const saveMessage=async(_0x378b7a,_0x53819e)=>{const _0x13666f=a15_0x512c1c,_0x13e250={};_0x13e250[_0x13666f(0x195)]=_0x13666f(0x1a6),_0x13e250['LnSdZ']=_0x13666f(0x193);const _0x44691f=_0x13e250,{companyId:_0x4ee0e3}=_0x378b7a[_0x13666f(0x142)],{message:_0x59f11b}=_0x378b7a[_0x13666f(0x10f)],{id:_0x5ef867}=_0x378b7a['params'],_0x32ee45=+_0x378b7a['user']['id'],_0x44c4cc=+_0x5ef867,_0x3aa450=_0x378b7a?.['files'],_0x568f7b=(0x0,lodash_1[_0x13666f(0x164)])(_0x3aa450),_0x387a5d={};_0x387a5d[_0x13666f(0x106)]=_0x44c4cc,_0x387a5d[_0x13666f(0x12d)]=_0x32ee45,_0x387a5d[_0x13666f(0x16e)]=_0x59f11b,_0x387a5d[_0x13666f(0x1b3)]=_0x568f7b?.[_0x13666f(0x11b)],_0x387a5d[_0x13666f(0x190)]=_0x568f7b?.['originalname'],_0x387a5d[_0x13666f(0xfc)]=_0x568f7b?.[_0x13666f(0x110)];const _0x9034f3=await(0x0,CreateMessageService_1[_0x13666f(0x15f)])(_0x387a5d),_0x16880b={};_0x16880b[_0x13666f(0x155)]=User_1[_0x13666f(0x15f)],_0x16880b['as']=_0x13666f(0x131);const _0x368c84={};_0x368c84[_0x13666f(0x155)]=ChatUser_1[_0x13666f(0x15f)],_0x368c84['as']=_0x44691f[_0x13666f(0x195)];const _0x16300d={};_0x16300d['include']=[_0x16880b,_0x368c84];const _0x26dd94=await Chat_1[_0x13666f(0x15f)][_0x13666f(0x133)](_0x44c4cc,_0x16300d),_0x21dcba=(0x0,socket_1[_0x13666f(0x117)])(),_0x59339f={};_0x59339f[_0x13666f(0x1a4)]=_0x44691f[_0x13666f(0x170)],_0x59339f[_0x13666f(0x14d)]=_0x9034f3,_0x59339f[_0x13666f(0x130)]=_0x26dd94,_0x21dcba[_0x13666f(0x1a7)](_0x13666f(0x16b)+_0x4ee0e3+'-chat-'+_0x44c4cc,_0x59339f);const _0x2fc441={};return _0x2fc441[_0x13666f(0x1a4)]=_0x13666f(0x193),_0x2fc441[_0x13666f(0x14d)]=_0x9034f3,_0x2fc441[_0x13666f(0x130)]=_0x26dd94,_0x21dcba[_0x13666f(0x1a7)](_0x13666f(0x16b)+_0x4ee0e3+_0x13666f(0x183),_0x2fc441),_0x53819e['json'](_0x9034f3);};exports[a15_0x512c1c(0x13e)]=saveMessage;const checkAsRead=async(_0x4c68b1,_0x3940f7)=>{const _0xc57be=a15_0x512c1c,_0x215e76={};_0x215e76[_0xc57be(0x191)]=_0xc57be(0x1a6),_0x215e76[_0xc57be(0x138)]=_0xc57be(0x174);const _0x3d71e2=_0x215e76,{companyId:_0x105256}=_0x4c68b1[_0xc57be(0x142)],{userId:_0x45a6b3}=_0x4c68b1['body'],{id:_0x2f8bb7}=_0x4c68b1[_0xc57be(0x1a8)],_0x247ef0={};_0x247ef0['chatId']=_0x2f8bb7,_0x247ef0[_0xc57be(0x172)]=_0x45a6b3;const _0x58b685={};_0x58b685[_0xc57be(0x18c)]=_0x247ef0;const _0x26ffc2=await ChatUser_1[_0xc57be(0x15f)]['findOne'](_0x58b685),_0x4bd87e={};_0x4bd87e['unreads']=0x0,await _0x26ffc2['update'](_0x4bd87e);const _0x311880={};_0x311880[_0xc57be(0x155)]=User_1[_0xc57be(0x15f)],_0x311880['as']=_0xc57be(0x131);const _0x5dfa9f={};_0x5dfa9f[_0xc57be(0x155)]=ChatUser_1['default'],_0x5dfa9f['as']=_0x3d71e2[_0xc57be(0x191)];const _0x1f8119={};_0x1f8119[_0xc57be(0x189)]=[_0x311880,_0x5dfa9f];const _0x4ba30b=await Chat_1[_0xc57be(0x15f)][_0xc57be(0x133)](_0x2f8bb7,_0x1f8119),_0x268343=(0x0,socket_1[_0xc57be(0x117)])(),_0x4a0591={};_0x4a0591[_0xc57be(0x1a4)]=_0x3d71e2[_0xc57be(0x138)],_0x4a0591[_0xc57be(0x130)]=_0x4ba30b,_0x268343['emit']('company-'+_0x105256+'-chat-'+_0x2f8bb7,_0x4a0591);const _0x48e41d={};return _0x48e41d['action']=_0x3d71e2[_0xc57be(0x138)],_0x48e41d['chat']=_0x4ba30b,_0x268343['emit'](_0xc57be(0x16b)+_0x105256+'-chat',_0x48e41d),_0x3940f7['json'](_0x4ba30b);};exports[a15_0x512c1c(0x188)]=checkAsRead;const messages=async(_0x2d8174,_0x34680c)=>{const _0x28b47d=a15_0x512c1c,{pageNumber:_0x390cdc}=_0x2d8174[_0x28b47d(0x156)],{id:_0x36ec10}=_0x2d8174['params'],_0x23b28c=+_0x2d8174['user']['id'],_0xd668b={};_0xd668b[_0x28b47d(0x106)]=_0x36ec10,_0xd668b[_0x28b47d(0x12c)]=_0x23b28c,_0xd668b['pageNumber']=_0x390cdc;const {records:_0x31f8df,count:_0x2e868d,hasMore:_0x423f24}=await(0x0,FindMessages_1[_0x28b47d(0x15f)])(_0xd668b),_0x1b42ac={};return _0x1b42ac[_0x28b47d(0x182)]=_0x31f8df,_0x1b42ac[_0x28b47d(0x113)]=_0x2e868d,_0x1b42ac[_0x28b47d(0x128)]=_0x423f24,_0x34680c[_0x28b47d(0x162)](_0x1b42ac);};function a15_0x2705(_0x3e528a,_0x31be55){const _0x2461ab=a15_0x1b1c();return a15_0x2705=function(_0x236bd0,_0x44c38d){_0x236bd0=_0x236bd0-0xf0;let _0x31c18f=_0x2461ab[_0x236bd0];return _0x31c18f;},a15_0x2705(_0x3e528a,_0x31be55);}exports[a15_0x512c1c(0x163)]=messages;function a15_0x25159c(_0x333eea){const _0x56a546=a15_0x512c1c,_0x5a6867={'Quilv':_0x56a546(0x19d),'upFod':_0x56a546(0x1b0),'ZJBGc':_0x56a546(0x18d),'oRhut':'string','HbGlu':_0x56a546(0x18b),'ZEuon':_0x56a546(0x13b),'sfWRI':function(_0x509b05,_0x354605){return _0x509b05===_0x354605;},'GlorX':_0x56a546(0x184),'hmqGs':_0x56a546(0x1a2),'IFhMD':function(_0xe571dd,_0x21a4f8){return _0xe571dd!==_0x21a4f8;},'UxaVF':function(_0x576b80,_0x5c91a3){return _0x576b80+_0x5c91a3;},'LGUaA':function(_0x6232e0,_0x22cd80){return _0x6232e0/_0x22cd80;},'aCRxT':_0x56a546(0x114),'EkbpY':'debu','ESInn':'action','ESSMW':'stateObject','ppVVK':function(_0x55ab64,_0x146142){return _0x55ab64(_0x146142);},'SdrVW':function(_0x21621d,_0x60e7b2){return _0x21621d+_0x60e7b2;},'OkFbL':_0x56a546(0x17d),'okvfu':_0x56a546(0x143),'ezKSh':function(_0x5d0f20,_0x5c261a){return _0x5d0f20===_0x5c261a;},'DsIKB':_0x56a546(0x1ac),'DWJFa':function(_0x4d70bd,_0xb60828){return _0x4d70bd(_0xb60828);}};function _0x1f99a8(_0x327c9b){const _0x5188db=_0x56a546,_0x29e639={};_0x29e639[_0x5188db(0x181)]='while\x20(true)\x20{}',_0x29e639['PIHGc']=_0x5a6867['Quilv'],_0x29e639[_0x5188db(0x15a)]=_0x5a6867[_0x5188db(0x14a)];const _0x423682=_0x29e639;if(_0x5188db(0x18d)!==_0x5a6867[_0x5188db(0x134)])return![];else{if(typeof _0x327c9b===_0x5a6867['oRhut'])return function(_0x277299){}[_0x5188db(0x17f)](_0x5a6867[_0x5188db(0x10e)])[_0x5188db(0xfe)](_0x5a6867[_0x5188db(0xf7)]);else{if(_0x5a6867[_0x5188db(0x12f)](_0x5a6867[_0x5188db(0xf4)],_0x5a6867[_0x5188db(0x192)]))return function(_0x3bc494){}[_0x5188db(0x17f)](_0x423682[_0x5188db(0x181)])[_0x5188db(0xfe)]('counter');else{if(_0x5a6867['IFhMD'](_0x5a6867['UxaVF']('',_0x5a6867[_0x5188db(0x153)](_0x327c9b,_0x327c9b))[_0x5188db(0x179)],0x1)||_0x327c9b%0x14===0x0){if(_0x5a6867['IFhMD'](_0x5a6867[_0x5188db(0x1a0)],_0x5a6867[_0x5188db(0x1a0)])){const _0x5c4f78={};return _0x5c4f78[_0x5188db(0x15f)]=_0x587b1a,_0x1117d1&&_0x702920[_0x5188db(0xfa)]?_0x395022:_0x5c4f78;}else(function(){return!![];}[_0x5188db(0x17f)](_0x5a6867[_0x5188db(0x158)](_0x5a6867['EkbpY'],_0x5188db(0x152)))['call'](_0x5a6867[_0x5188db(0xff)]));}else(function(){const _0x383521=_0x5188db;if(_0x423682[_0x383521(0x15e)]!==_0x423682[_0x383521(0x15a)])return![];else{const _0x111e3f={};_0x111e3f['action']=_0x383521(0x196),_0x111e3f[_0x383521(0x141)]=_0x4b9c61,_0x3f98ec['emit'](_0x383521(0x16b)+_0x2cd613+_0x383521(0x12b)+_0x3990ff[_0x383521(0x172)],_0x111e3f);}}[_0x5188db(0x17f)](_0x5a6867[_0x5188db(0x15c)]+_0x5188db(0x152))[_0x5188db(0xfe)](_0x5a6867[_0x5188db(0x17b)]));}}_0x1f99a8(++_0x327c9b);}}try{if(_0x5a6867[_0x56a546(0x19c)](_0x5a6867[_0x56a546(0x116)],_0x5a6867['okvfu'])){if(_0x26c46b){const _0x638e33=_0x10f65c['apply'](_0x3b9e64,arguments);return _0x119a16=null,_0x638e33;}}else{if(_0x333eea){if(_0x5a6867[_0x56a546(0x1ad)](_0x5a6867[_0x56a546(0x12e)],_0x5a6867[_0x56a546(0x12e)]))return _0x1f99a8;else _0x3f636a=_0x5a6867[_0x56a546(0x14f)](_0x1665bd,_0x5a6867[_0x56a546(0x11c)](_0x5a6867['SdrVW'](_0x56a546(0x1a5),_0x5a6867[_0x56a546(0x101)]),');'))();}else _0x5a6867[_0x56a546(0x1a3)](_0x1f99a8,0x0);}}catch(_0xa30d1e){}}